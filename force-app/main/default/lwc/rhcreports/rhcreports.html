<template>
    <template if:true={Spinner}>
        <div id="spinnerId" class="slds-spinner_container">
            <div class="slds-spinner--brand  slds-spinner slds-spinner--large slds-is-relative" role="alert">
                <span class="slds-assistive-text">Loading</span>
                <div class="slds-spinner__dot-a"></div>
                <div class="slds-spinner__dot-b"></div>
            </div>
        </div>
    </template>
    
    <div class="slds-col"> 
        <div class="slds-form-element reportDiv paddingleft" style="width: 200px">
            <div class="slds-form-element__label">Report:</div>
            <div>
                <select class="slds-select" onchange={onReportChange} id="InputSelectReport">
                    <template for:each={selReports} for:item="reportVal"> 
                        <option value={reportVal} title={reportVal} key={reportVal}></option> 
                    </template>
                </select>
                <br/>
            </div>
        </div>
    </div>
    
    <div class="slds-col">
        <div class="slds-form-element roleDiv" style="width: 300px">
            <div class="slds-form-element__label">Accounts: </div>
            <div>
                <select class="slds-select" name="InputSelectAccount" disabled={accSelectDisabled} onchange={getFormInputChange}>
                    <template for:each={selAccounts} for:item="accountName"> 
                        <option value={accountName} title={accountName} key={accountName}></option> 
                    </template>
                </select>
            </div>
        </div>
    </div>
    
    <template if:true={showExtraFilters}>
        <br/>
    
    <table>
        <tr>
        <td>
        
                <lightning-dual-listbox name="languages"  
                           label= "Select ADOs (Optional)" 
                           source-label="Available" 
                           selected-label="Selected" 
                           options={adoListChoose} 
                           onchange={handleADOChange}>
                        </lightning-dual-listbox>
                
        </td>
    <td>
                <lightning-dual-listbox name="languages"  
                           label= "Select RVPs (Optional)" 
                           source-label="Available" 
                           selected-label="Selected" 
                           options={rvpListChoose} 
                           onchange={handleRVPChange}>
                           </lightning-dual-listbox>
                           &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        </td>
            
    <td>
                <lightning-dual-listbox name="languages"  
                           label= "Select DVPs (Optional)" 
                           source-label="Available" 
                           selected-label="Selected" 
                           options={dvpListChoose} 
                           onchange={handleDVPChange}>
                        </lightning-dual-listbox>
        </td>        
            </tr>
        </table>
    
    </template>
    
    <br/>
    <div class="slds-col paddingleft paddingTop">
        <div class="slds-form-element">
            
            <lightning-button id="reportButton" label="Go" onclick={runReports}></lightning-button>
        </div>
    </div>
    <br/>
    
    <div>
        <template if:true={showFacility}>
            <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                <thead>
                    <tr class="slds-text-title--caps">
                        <th scope="row">
                            <div class="slds-truncate" >Account Name: <lightning-formatted-text value={facility.Name}></lightning-formatted-text></div>
                        </th>
                        <th scope="row">
                            <div class="slds-truncate" >Product Type: <lightning-formatted-text value={facility.PF_Product_Type__c}></lightning-formatted-text></div>
                        </th>
                        <th scope="row">
                            <div class="slds-truncate" >Smart #: <lightning-formatted-text value={facility.PF_Smart_ID__c}></lightning-formatted-text></div>
                        </th>
                        <th scope="row">
                            <div class="slds-truncate" >SAP ID: <lightning-formatted-text value={facility.PF_SAP_ID__c}></lightning-formatted-text></div>
                        </th>
                    </tr>
                </thead>
            </table>
        </template>
        <template if:true={report1}>
            <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                <th>
                    <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                        <thead>
                            <tr class="slds-text-title--caps">
                                <th scope="row">
                                    <div class="slds-truncate" >DVPs: </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <template for:each={paginationListDVP} for:item="con">  
                                    <th scope="row" key={con.Id}>
                                        <div class="slds-truncate" title={con.firstName}><lightning-formatted-text value={con.FirstName}></lightning-formatted-text>&nbsp;<lightning-formatted-text value={con.LastName}></lightning-formatted-text></div>
                                    </th>
                                </template>
                            </tr>
                        </tbody>
                    </table>
                </th>
                <th>
                    <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                        <thead>
                            <tr class="slds-text-title--caps">
                                <th scope="row">
                                    <div class="slds-truncate" >RVPs: </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <template for:each={paginationListRVP} for:item="con">  
                                    <th scope="row" key={con.Id}>
                                        <div class="slds-truncate" title={con.firstName}><lightning-formatted-text value={con.FirstName}></lightning-formatted-text>&nbsp;<lightning-formatted-text value={con.LastName}></lightning-formatted-text></div>
                                    </th>
                                </template>
                            </tr>
                        </tbody>
                    </table>
                </th>
                <th>
                    <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                        <thead>
                            <tr class="slds-text-title--caps">
                                <th scope="row">
                                    <div class="slds-truncate" >ADOs: </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <template for:each={paginationListADO} for:item="con">  
                                    <th scope="row" key={con.Id}>
                                        <div class="slds-truncate" title={con.firstName}><lightning-formatted-text value={con.FirstName}></lightning-formatted-text>&nbsp;<lightning-formatted-text value={con.LastName}></lightning-formatted-text></div>
                                    </th>
                                </template>
                            </tr>
                        </tbody>
                    </table>
                </th>
            </table>
            <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                <thead>
                    <tr class="slds-text-title--caps">
                        
                        <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortName}>
                            <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                <span class="slds-assistive-text">Sort</span>
                                <span class="slds-truncate" title="accountName">Name</span>  
                            </a>
                        </th>
                        
                        <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortTitle}>
                            <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                <span class="slds-assistive-text">Sort</span>
                                <span class="slds-truncate" title="ownerName">Title</span>
                            </a>
                        </th>
                        
                        <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortAddress}>
                            <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                <span class="slds-assistive-text">Sort</span>
                                <span class="slds-truncate" title="activity">Address</span>
                            </a>
                        </th>
                        
                        <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortCity}>
                            <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                <span class="slds-assistive-text">Sort</span>
                                <span class="slds-truncate" title="activity">City</span>
                            </a>
                        </th>
                        
                        <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortState}>
                            <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                <span class="slds-assistive-text">Sort</span>
                                <span class="slds-truncate" title="activity">State</span>
                            </a>
                        </th>
                        
                        <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortZip}>
                            <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                <span class="slds-assistive-text">Sort</span>
                                <span class="slds-truncate" title="activity">Zip</span>
                            </a>
                        </th>
                        
                        <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortPhone}>
                            <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                <span class="slds-assistive-text">Sort</span>
                                <span class="slds-truncate" title="Department">Phone</span>
                            </a>
                        </th>
                    </tr>
                </thead>
                
                <tbody>
                    <template for:each={paginationList} for:item="con">  
                        <tr key={con.Id}>
                                <th scope="row">
                                    <div class="slds-truncate" title={con.Name}><lightning-formatted-url value={con.Id} label={con.Name} target="_blank" onclick={openItem}></lightning-formatted-url></div>
                                </th>
                                
                                <th scope="row">
                                    <div class="slds-truncate" title={con.Title}><lightning-formatted-text value={con.Title}></lightning-formatted-text></div>
                                </th>
                                
                                <th scope="row">
                                    <div class="slds-truncate" title={con.MailingStreet}><lightning-formatted-text value={con.MailingStreet}></lightning-formatted-text></div>
                                </th>
                                
                                <th scope="row">
                                    <div class="slds-truncate" title={con.MailingCity}><lightning-formatted-text value={con.MailingCity}></lightning-formatted-text></div>
                                </th>
                                
                                <th scope="row">
                                    <div class="slds-truncate" title={con.MailingState}><lightning-formatted-text value={con.MailingState}></lightning-formatted-text></div>
                                </th>
                                
                                <th scope="row">
                                    <div class="slds-truncate" title={con.MailingPostalCode}><lightning-formatted-text value={con.MailingPostalCode}></lightning-formatted-text></div>
                                </th>
                                
                                <th scope="row">
                                    <div class="slds-truncate" title={con.Phone}><lightning-formatted-text value={con.Phone}></lightning-formatted-text></div>
                                </th>  
                        </tr>
                    </template>
                </tbody>
            </table>
            <lightning-button label="Previous" onclick={previous}></lightning-button>
			<lightning-button label="Next" onclick={next}></lightning-button><br/>
        </template>
        
        <template if:true={report2}>
            <template if:true={showPageListDVPAct}>
                <div class="slds-p-around--large">
                    DVPs
                    <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                        <thead>
                            <tr class="slds-text-title--caps">
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortDVPName}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="First Name">Activity Owner</div>
                                    </a>
                                </th>
                                
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortDVPType}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        
                                        <div class="slds-truncate" title="First Name">Activity Type</div>
                                    </a>
                                </th>
                                
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortDVPDate}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="First Name">Date</div>
                                    </a>
                                </th>
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortDVPDescription}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="Department">Description</div>
                                    </a>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <template for:each={paginationListDVPAct} for:item="dvp">
                                    <tr key={dvp.Id}>
                                        <th >
                                            
                                            <div class="slds-truncate" title={dvp.name}><lightning-formatted-url value={dvp.Owner.Id} onclick={openItem} label={dvp.Owner.Name} target="_blank"></lightning-formatted-url></div>
                                            
                                        </th>
                                        
                                        <th >
                                            
                                            <div class="slds-truncate" title={dvp.Type}><lightning-formatted-text value={dvp.Type}></lightning-formatted-text></div>
                                            
                                        </th>
                                        
                                        <th >
                                            
                                            <div class="slds-truncate" title={dvp.StartDateTime}><lightning-formatted-date-time value={dvp.StartDateTime}></lightning-formatted-date-time></div>
                                            
                                        </th>
                                        
                                        <th >
                                            <div class="slds-truncate" title={dvp.Description}><lightning-formatted-text value={dvp.Description}></lightning-formatted-text></div>
                                            
                                        </th>
                                    </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </template>
            <template if:true={showPageListRVPAct}>
                <div class="slds-p-around--large">
                    RVPs
                    <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                        <thead>
                            <tr class="slds-text-title--caps">
                                
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortRVPName}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="First Name">Activity Owner</div>
                                    </a>
                                </th>
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortRVPType}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        
                                        <div class="slds-truncate" title="First Name">Activity Type</div>
                                    </a>
                                </th>
                                
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortRVPDate}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="First Name">Date</div>
                                    </a>
                                </th>
                                
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortRVPDescription}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="Department">Description</div>
                                    </a>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <template for:each={paginationListRVPAct} for:item="rvp">
                                    <tr key={rvp.Id}>
                                        <th>
                                            <div class="slds-truncate" title={rvp.name}><lightning-formatted-url value={rvp.Owner.Id} label={rvp.Owner.Name} target="_blank" onclick={openItem}></lightning-formatted-url></div>
                                        </th>
                                        
                                        <th>
                                            <div class="slds-truncate" title={rvp.Type}><lightning-formatted-text value={rvp.Type}></lightning-formatted-text></div>
                                        </th>
                                        
                                        <th>
                                            <div class="slds-truncate" title={rvp.StartDateTime}><lightning-formatted-date-time value={rvp.StartDateTime}></lightning-formatted-date-time></div>
                                            
                                        </th>
                                        
                                        <th >
                                            <div class="slds-truncate" title={rvp.Description}><lightning-formatted-text value={rvp.Description}></lightning-formatted-text></div>
                                        </th>
                                    </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </template>
            <template if:true={showPageListADOAct}>
                <div class="slds-p-around--large">
                    ADOs
                    <table class="slds-table slds-table--bordered slds-table--cell-buffer">
                        <thead>
                            <tr class="slds-text-title--caps">
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortADOName}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="First Name">Activity Owner</div>
                                    </a>
                                </th>
                                
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortADOType}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="First Name">Activity Type</div>
                                    </a>
                                </th>
                                
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortADODate}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="First Name">Date</div>
                                    </a>
                                </th>
                                
                                <th class="slds-is-sortable slds-text-title--caps" scope="col" onclick={sortADODescription}>
                                    <a href="javascript:void(0);" class="slds-th__action slds-text-link--reset">
                                        <div class="slds-truncate" title="Department">Description</div>
                                    </a>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <template for:each={paginationListADOAct} for:item="ado">
                                    <tr key={ado.Id}>
                                        <th scope="row">
                                            <div class="slds-truncate" title={ado.name}><lightning-formatted-url value={ado.Owner.Id} label={ado.Owner.Name} onclick={openItem} target="_blank"></lightning-formatted-url></div>
                                        </th>
                                        <th scope="row">
                                            <div class="slds-truncate" title={ado.Type}><lightning-formatted-text value={ado.Type}></lightning-formatted-text></div>
                                        </th>
                                        <th scope="row">
                                            <div class="slds-truncate" title={ado.StartDateTime}><lightning-formatted-date-time value={ado.StartDateTime}></lightning-formatted-date-time></div>
                                        </th>
                                        <th scope="row">
                                            <div class="slds-truncate" title={ado.Description}><lightning-formatted-text value={ado.Description}></lightning-formatted-text></div>
                                        </th>
                                    </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </template>
        </template>
        
        <template if:true={showAlpha}>
            <lightning:Tabset>
                <lightning-tab label="A" aura:id="detailTabA" onactive={onTabChangeA}></lightning-tab>
                <lightning-tab label="B" aura:id="detailTabB" onactive={onTabChangeB}></lightning-tab>
                <lightning-tab label="C" aura:id="detailTabC" onactive={onTabChangeC}></lightning-tab>
                <lightning-tab label="D" aura:id="detailTabD" onactive={onTabChangeD}></lightning-tab>
                <lightning-tab label="E" aura:id="detailTabE" onactive={onTabChangeE}></lightning-tab>
                <lightning-tab label="F" aura:id="detailTabF" onactive={onTabChangeF}></lightning-tab>
                <lightning-tab label="G" aura:id="detailTabG" onactive={onTabChangeG}></lightning-tab>
                <lightning-tab label="H" aura:id="detailTabH" onactive={onTabChangeH}></lightning-tab>
                <lightning-tab label="I" aura:id="detailTabI" onactive={onTabChangeI}></lightning-tab>
                <lightning-tab label="J" aura:id="detailTabJ" onactive={onTabChangeJ}></lightning-tab>
                <lightning-tab label="K" aura:id="detailTabK" onactive={onTabChangeK}></lightning-tab>
                <lightning-tab label="L" aura:id="detailTabL" onactive={onTabChangeL}></lightning-tab>
                <lightning-tab label="M" aura:id="detailTabM" onactive={onTabChangeM}></lightning-tab>
                <lightning-tab label="N" aura:id="detailTabN" onactive={onTabChangeN}></lightning-tab>
                <lightning-tab label="O" aura:id="detailTabO" onactive={onTabChangeO}></lightning-tab>
                <lightning-tab label="P" aura:id="detailTabP" onactive={onTabChangeP}></lightning-tab>
                <lightning-tab label="Q" aura:id="detailTabQ" onactive={onTabChangeQ}></lightning-tab>
                <lightning-tab label="R" aura:id="detailTabR" onactive={onTabChangeR}></lightning-tab>
                <lightning-tab label="S" aura:id="detailTabS" onactive={onTabChangeS}></lightning-tab>
                <lightning-tab label="T" aura:id="detailTabT" onactive={onTabChangeT}></lightning-tab>
                <lightning-tab label="U" aura:id="detailTabU" onactive={onTabChangeU}></lightning-tab>
                <lightning-tab label="V" aura:id="detailTabV" onactive={onTabChangeV}></lightning-tab>
                <lightning-tab label="W" aura:id="detailTabW" onactive={onTabChangeW}></lightning-tab>
                <lightning-tab label="X" aura:id="detailTabX" onactive={onTabChangeX}></lightning-tab>
                <lightning-tab label="Y" aura:id="detailTabY" onactive={onTabChangeY}></lightning-tab>
                <lightning-tab label="Z" aura:id="detailTabZ" onactive={onTabChangeZ}></lightning-tab>
                </lightning:Tabset>
            <lightning-button id="exportButton" label="Export" onclick={downloadCsvAllAccount} ></lightning-button>
            <br/>
            <br/>
            <template for:each={accountTeamAndADO} for:item="con">
                <template if:true={showCon}>
            <table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                	<thead >
                    	<tr class="slds-text-title--caps">
                        	<th scope="row">
                            	<div class="slds-truncate" title={con.a.Name}>Account: <lightning-formatted-url value={con.a.Id} label={con.a.Name} onclick={openItem} target="_blank"></lightning-formatted-url></div>
                        	</th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.PF_Product_Type__c}>Product Type: <lightning-formatted-text value={con.a.PF_Product_Type__c}></lightning-formatted-text></div>
                            </th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.PF_Start_Date__c}>Start Date: <lightning-formatted-date-time value={con.a.PF_Start_Date__c} format="MM/dd/yyyy"></lightning-formatted-date-time></div>
                            </th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.Last_Date_of_Service__c}>Last Date of Service: <lightning-formatted-date-time value={con.a.PF_Start_Date__c} format="MM/dd/yyyy"></lightning-formatted-date-time></div>
                            </th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.PF_SAP_ID__c}>SAP: <lightning-formatted-text value={con.a.PF_SAP_ID__c}></lightning-formatted-text></div>
                            </th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.PF_Smart_ID__c}>SMART: <lightning-formatted-text value={con.a.PF_Smart_ID__c}></lightning-formatted-text></div>
                            </th>
                    	</tr>
                	</thead>
            	</table>
                    </template>
            	<template if:true={showConADO}>
                ADOs
            	<table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                    <thead>
                        <tr class="slds-text-title--caps">
                            <th scope="row">
                                <span title="Name">Name</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Title</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Email</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={con.ados} for:item="add">  
                                <tr key={add.Id}>
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Name}><lightning-formatted-url value={add.Id} label={add.Name} target="_blank" onclick={openItem}></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Title}><lightning-formatted-text value={add.Title}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Email}><lightning-formatted-text value={add.Email}></lightning-formatted-text></div>
                                    </th>
                                </tr>
                        </template>
                    </tbody>
                </table>
            	</template>
                <template if:true={showConDVP}>
                DVPs
            	<table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                    <thead>
                        <tr class="slds-text-title--caps">
                            <th scope="row">
                                <span title="Name">Name</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Title</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Email</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={con.dvps} for:item="add">  
                                <tr key={add.Id}>
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Name}><lightning-formatted-url value={add.Id} label={add.Name} target="_blank" onclick={openItem}></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Title}><lightning-formatted-text value={add.Title}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Email}><lightning-formatted-text value={add.Email}></lightning-formatted-text></div>
                                    </th>
                                </tr>
                        </template>
                    </tbody>
                </table>
            	</template>
                <template if:true={showConRVP}>
                RVPs
            	<table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                    <thead>
                        <tr class="slds-text-title--caps">
                            <th scope="row">
                                <span title="Name">Name</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Title</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Email</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={con.rvps} for:item="add">  
                                <tr key={add.Id}>
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Name}><lightning-formatted-url value={add.Id} label={add.Name} target="_blank" onclick={openItem}></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Title}><lightning-formatted-text value={add.Title}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Email}><lightning-formatted-text value={add.Email}></lightning-formatted-text></div>
                                    </th>
                                </tr>
                        </template>
                    </tbody>
                </table>
            	</template>
                <template if:true={showConCTeam}>
                Contact Team
                <table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                    <thead>
                        <tr class="slds-text-title--caps">
                            <th scope="row">
                                <span title="Name">Name</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Title</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Email</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={con.cTeam} for:item="add">  
                                <tr key={add.Id}>
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Name}><lightning-formatted-url value={add.Id} label={add.Name} target="_blank" onclick={openItem}></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Title}><lightning-formatted-text value={add.Title}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Email}><lightning-formatted-text value={add.Email}></lightning-formatted-text></div>
                                    </th>
                                </tr>
                        </template>
                    </tbody>
                </table>
                </template>
                <template if:true={showCon}>
                Contacts
                <table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                    <thead>
                        <tr class="slds-text-title--caps">
                            <th scope="row">
                                <span title="Name">Name</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Title</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Email</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={con.cons} for:item="add">  
                                <tr key={add.Id}>
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Name}><lightning-formatted-url value={add.Id} label={add.Name} target="_blank" onclick={openItem}></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Title}><lightning-formatted-text value={add.Title}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Email}><lightning-formatted-text value={add.Email}></lightning-formatted-text></div>
                                    </th>
                                </tr>
                        </template>
                    </tbody>
                </table>
                </template>
            </template>
        </template>
        <br/>
        <br/>
        <template if:true={report4}>
            <br/>
            <br/>
            <template for:each={NPSActivityList} for:item="con">
                <template if:true={showAcc}>
            <table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                	<thead>
                    	<tr class="slds-text-title--caps">
                        	<th scope="row">
                            	<div class="slds-truncate" title={con.a.Name}>Account: <lightning-formatted-url value={con.a.Id} label={con.a.Name} onclick={openItem} target="_blank"></lightning-formatted-url></div>
                        	</th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.PF_Product_Type__c}>Product Type: <lightning-formatted-text value={con.a.PF_Product_Type__c}></lightning-formatted-text></div>
                            </th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.PF_Start_Date__c}>Start Date: <lightning-formatted-date-time value={con.a.PF_Start_Date__c} format="MM/dd/yyyy"></lightning-formatted-date-time></div>
                            </th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.Last_Date_of_Service__c}>Last Date of Service: <lightning-formatted-date-time value={con.a.PF_Start_Date__c} format="MM/dd/yyyy"></lightning-formatted-date-time></div>
                            </th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.PF_SAP_ID__c}>SAP: <lightning-formatted-text value={con.a.PF_SAP_ID__c}></lightning-formatted-text></div>
                            </th>
                            <th scope="row">
                            	<div class="slds-truncate" title={con.a.PF_Smart_ID__c}>SMART: <lightning-formatted-text value={con.a.PF_Smart_ID__c}></lightning-formatted-text></div>
                            </th>
                    	</tr>
                	</thead>
            	</table>
                    </template>
            	<template if:true={showConADO}>
                ADOs
            	<table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                    <thead>
                        <tr class="slds-text-title--caps">
                            <th scope="row">
                                <span title="Name">Name</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Title</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Email</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={con.ados} for:item="add">  
                                <tr key={add.Id}>
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Name}><lightning-formatted-url value={add.Id} label={add.Name} onclick={openItem} target="_blank"></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Title}><lightning-formatted-text value={add.Title}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Email}><lightning-formatted-text value={add.Email}></lightning-formatted-text></div>
                                    </th>
                                </tr>
                        </template>
                    </tbody>
                </table>
            	</template>
                <template if:true={showConDVP}>
                DVPs
            	<table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                    <thead>
                        <tr class="slds-text-title--caps">
                            <th scope="row">
                                <span title="Name">Name</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Title</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Email</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={con.dvps} for:item="add">  
                                <tr key={add.Id}>
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Name}><lightning-formatted-url value={add.Id} label={add.Name} onclick={openItem} target="_blank"></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Title}><lightning-formatted-text value={add.Title}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Email}><lightning-formatted-text value={add.Email}></lightning-formatted-text></div>
                                    </th>
                                </tr>
                        </template>
                    </tbody>
                </table>
            	</template>
                <template if:true={showConRVP}>
                RVPs
            	<table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                    <thead>
                        <tr class="slds-text-title--caps">
                            <th scope="row">
                                <span title="Name">Name</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Title</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Email</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={con.rvps} for:item="add">  
                                <tr key={add.Id}>
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Name}><lightning-formatted-url value={add.Id} label={add.Name} onclick={openItem} target="_blank"></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Title}><lightning-formatted-text value={add.Title}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Email}><lightning-formatted-text value={add.Email}></lightning-formatted-text></div>
                                    </th>
                                </tr>
                        </template>
                    </tbody>
                </table>
            	</template>
                <template if:true={showConTasks}>
                Activities
                <table class="slds-table slds-table--bordered slds-table--cell-buffer" key={con.Id}>
                    <thead>
                        <tr class="slds-text-title--caps">
                            <th scope="row">
                                <span title="Name">Assigned</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Subject</span>
                            </th>
                            <th scope="row">
                                <span title="Name">NPS Score</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Product Type</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Date</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Priority</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Status</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Full Comments</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Last Modified Date</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Company/Account</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Contact</span>
                            </th>
                            <th scope="row">
                                <span title="Name">Title</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={con.tasks} for:item="add">  
                                <tr key={add.Id}>
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Owner.Name}><lightning-formatted-url value={add.Owner.Id} label={add.Owner.Name} onclick={openItem} target="_blank"></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Subject}><lightning-formatted-url value={add.Id} label={add.Subject} onclick={openItem} target="_blank"></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.PF_NPS_Score__c}><lightning-formatted-text value={add.PF_NPS_Score__c}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.PF_Product_Type__c}><lightning-formatted-text value={add.PF_Product_Type__c}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.ActivityDate}><lightning-formatted-url value={ActivityDate} format="MM/dd/yyyy" onclick={openItem}></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Priority}><lightning-formatted-text value={add.Priority}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Status}><lightning-formatted-text value={add.Status}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row" >
                                        <div class="slds-truncate" style="width:100px" title={add.Description}><lightning-formatted-text value={add.Description}></lightning-formatted-text></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.LastModifiedDate}><lightning-formatted-date-time value={add.LastModifiedDate} format="MM/dd/yyyy hh:mm a"></lightning-formatted-date-time></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.What.Name}><lightning-formatted-url value={add.WhatId} label={add.What.Name} onclick={openItem} target="_blank"></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Who.Name}><lightning-formatted-url value={add.WhoId} label={add.Who.Name} target="_blank" onclick={openItem}></lightning-formatted-url></div>
                                    </th>
                                    
                                    <th scope="row">
                                        <div class="slds-truncate" title={add.Who.Title}><lightning-formatted-text value={add.Who.Title}></lightning-formatted-text></div>
                                    </th>
                                </tr>
                        </template>
                    </tbody>
                </table>
                </template>
            </template>
            <br/>
            <br/>
        </template>
    </div>
</template>